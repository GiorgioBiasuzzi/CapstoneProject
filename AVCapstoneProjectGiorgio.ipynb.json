{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {
    "scrolled": false
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Dates</th>\n",
       "      <th>Adj Close</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>2010-01-04</td>\n",
       "      <td>0.426354</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2010-01-05</td>\n",
       "      <td>0.478560</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>2010-01-06</td>\n",
       "      <td>0.513364</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>2010-01-07</td>\n",
       "      <td>0.513364</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>2010-01-08</td>\n",
       "      <td>0.478560</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2766</th>\n",
       "      <td>2020-12-29</td>\n",
       "      <td>2.220000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2767</th>\n",
       "      <td>2020-12-30</td>\n",
       "      <td>2.260000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2768</th>\n",
       "      <td>2020-12-31</td>\n",
       "      <td>2.290000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2769</th>\n",
       "      <td>2021-01-04</td>\n",
       "      <td>2.150000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2770</th>\n",
       "      <td>2021-01-05</td>\n",
       "      <td>2.137500</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>2771 rows Ã— 2 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "          Dates  Adj Close\n",
       "0    2010-01-04   0.426354\n",
       "1    2010-01-05   0.478560\n",
       "2    2010-01-06   0.513364\n",
       "3    2010-01-07   0.513364\n",
       "4    2010-01-08   0.478560\n",
       "...         ...        ...\n",
       "2766 2020-12-29   2.220000\n",
       "2767 2020-12-30   2.260000\n",
       "2768 2020-12-31   2.290000\n",
       "2769 2021-01-04   2.150000\n",
       "2770 2021-01-05   2.137500\n",
       "\n",
       "[2771 rows x 2 columns]"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/Users/giorgiobiasuzzi/opt/anaconda3/envs/MLEnvCapstone/lib/python3.7/site-packages/ipykernel_launcher.py:39: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "/Users/giorgiobiasuzzi/opt/anaconda3/envs/MLEnvCapstone/lib/python3.7/site-packages/ipykernel_launcher.py:40: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "array([[0.42635357],\n",
       "       [0.47856012],\n",
       "       [0.51336449],\n",
       "       ...,\n",
       "       [2.28999996],\n",
       "       [2.1500001 ],\n",
       "       [2.13750005]])"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "(2771, 1)\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "array([[0.42635357],\n",
       "       [0.47856012],\n",
       "       [0.51336449],\n",
       "       ...,\n",
       "       [2.80805421],\n",
       "       [3.00110793],\n",
       "       [2.90458083]])"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/plain": [
       "array([[2.9221313 ],\n",
       "       [2.9221313 ],\n",
       "       [2.84315491],\n",
       "       [2.84315491],\n",
       "       [2.84315491],\n",
       "       [2.84315491],\n",
       "       [2.84315491],\n",
       "       [2.84315491],\n",
       "       [2.74662805],\n",
       "       [2.80805421],\n",
       "       [2.83437991],\n",
       "       [2.71152711],\n",
       "       [2.71152711],\n",
       "       [2.76417828],\n",
       "       [2.76417828],\n",
       "       [2.70275187],\n",
       "       [2.70275187],\n",
       "       [2.70275187],\n",
       "       [2.70275187],\n",
       "       [2.63255048],\n",
       "       [2.63255048],\n",
       "       [2.63255048],\n",
       "       [2.63255048],\n",
       "       [2.53602409],\n",
       "       [2.51847339],\n",
       "       [2.62377572],\n",
       "       [2.50969839],\n",
       "       [2.67642641],\n",
       "       [2.67642641],\n",
       "       [2.7203021 ],\n",
       "       [2.66765118],\n",
       "       [2.66765118],\n",
       "       [2.77295375],\n",
       "       [2.77295375],\n",
       "       [2.75540304],\n",
       "       [2.75540304],\n",
       "       [2.75540304],\n",
       "       [2.78172874],\n",
       "       [2.52724886],\n",
       "       [2.50969839],\n",
       "       [2.3692956 ],\n",
       "       [2.35174537],\n",
       "       [2.35174537],\n",
       "       [2.35174537],\n",
       "       [2.43949699],\n",
       "       [2.42194676],\n",
       "       [2.42194676],\n",
       "       [2.42194676],\n",
       "       [2.34297037],\n",
       "       [2.50092316],\n",
       "       [2.50092316],\n",
       "       [2.29909444],\n",
       "       [2.29909444],\n",
       "       [2.29909444],\n",
       "       [2.12359095],\n",
       "       [2.24644327],\n",
       "       [2.24644327],\n",
       "       [2.24644327],\n",
       "       [2.24644327],\n",
       "       [2.25521851],\n",
       "       [2.2288928 ],\n",
       "       [2.27276897],\n",
       "       [2.2288928 ],\n",
       "       [2.2288928 ],\n",
       "       [2.28154397],\n",
       "       [2.20256734],\n",
       "       [2.27276897],\n",
       "       [2.34297037],\n",
       "       [2.34297037],\n",
       "       [2.34297037],\n",
       "       [2.41317153],\n",
       "       [2.41317153],\n",
       "       [2.41317153],\n",
       "       [2.41317153],\n",
       "       [2.41317153],\n",
       "       [2.41317153],\n",
       "       [2.41317153],\n",
       "       [2.41317153],\n",
       "       [2.41317153],\n",
       "       [2.70275187],\n",
       "       [2.70275187],\n",
       "       [2.70275187],\n",
       "       [2.70275187],\n",
       "       [2.79927921],\n",
       "       [2.79927921],\n",
       "       [2.79927921],\n",
       "       [2.76417828],\n",
       "       [2.76417828],\n",
       "       [2.70275187],\n",
       "       [2.76417828],\n",
       "       [2.76417828],\n",
       "       [2.76417828],\n",
       "       [2.76417828],\n",
       "       [2.76417828],\n",
       "       [2.76417828],\n",
       "       [2.70275187],\n",
       "       [2.60622525],\n",
       "       [2.60622525],\n",
       "       [2.59745026],\n",
       "       [2.78172874],\n",
       "       [2.79050398],\n",
       "       [2.79050398],\n",
       "       [2.79050398],\n",
       "       [2.79050398],\n",
       "       [2.79050398],\n",
       "       [2.79050398],\n",
       "       [3.07130909],\n",
       "       [3.00110793],\n",
       "       [3.00110793],\n",
       "       [2.98355746],\n",
       "       [2.88703084],\n",
       "       [2.88703084],\n",
       "       [2.88703084],\n",
       "       [2.85193014],\n",
       "       [2.85193014],\n",
       "       [2.85193014],\n",
       "       [2.85193014],\n",
       "       [2.98355746],\n",
       "       [2.98355746],\n",
       "       [3.15028572],\n",
       "       [3.13273525],\n",
       "       [3.13273525],\n",
       "       [3.19996142],\n",
       "       [2.86831307],\n",
       "       [2.86831307],\n",
       "       [2.86831307],\n",
       "       [2.86831307],\n",
       "       [2.86831307],\n",
       "       [2.77867794],\n",
       "       [2.77867794],\n",
       "       [2.77867794],\n",
       "       [2.98483801],\n",
       "       [2.90416694],\n",
       "       [2.90416694],\n",
       "       [2.9400208 ],\n",
       "       [2.95794773],\n",
       "       [2.90416694],\n",
       "       [3.02965569],\n",
       "       [3.02965569],\n",
       "       [3.01172853],\n",
       "       [3.01172853],\n",
       "       [2.98483801],\n",
       "       [2.98483801],\n",
       "       [3.03861904],\n",
       "       [2.91313028],\n",
       "       [2.91313028],\n",
       "       [2.91313028],\n",
       "       [2.85038614],\n",
       "       [2.85038614],\n",
       "       [2.77867794],\n",
       "       [2.77867794],\n",
       "       [2.77867794],\n",
       "       [2.77867794],\n",
       "       [2.72489715],\n",
       "       [2.72489715],\n",
       "       [2.72489715],\n",
       "       [2.67111635],\n",
       "       [2.67111635],\n",
       "       [2.67111635],\n",
       "       [2.64422584],\n",
       "       [2.61733556],\n",
       "       [2.71593356],\n",
       "       [2.59940863],\n",
       "       [2.42910266],\n",
       "       [2.64422584],\n",
       "       [2.44702959],\n",
       "       [2.42013907],\n",
       "       [2.42013907],\n",
       "       [2.42013907],\n",
       "       [2.47391987],\n",
       "       [2.47391987],\n",
       "       [2.47391987],\n",
       "       [2.47391987],\n",
       "       [2.47391987],\n",
       "       [2.33050418],\n",
       "       [2.33050418],\n",
       "       [2.33050418],\n",
       "       [2.33050418],\n",
       "       [2.35739493],\n",
       "       [2.42013907],\n",
       "       [2.42013907],\n",
       "       [2.42013907],\n",
       "       [2.42013907],\n",
       "       [2.42013907],\n",
       "       [2.42013907],\n",
       "       [2.46495652],\n",
       "       [2.46495652],\n",
       "       [2.46495652],\n",
       "       [2.46495652],\n",
       "       [2.46495652],\n",
       "       [2.46495652],\n",
       "       [2.46495652],\n",
       "       [2.45599294],\n",
       "       [2.5814817 ],\n",
       "       [2.50977373],\n",
       "       [2.50977373],\n",
       "       [2.50977373],\n",
       "       [2.50977373],\n",
       "       [2.55459118],\n",
       "       [2.55459118],\n",
       "       [2.59940863],\n",
       "       [2.59940863],\n",
       "       [2.53666425],\n",
       "       [2.53666425],\n",
       "       [2.56355453],\n",
       "       [2.47391987],\n",
       "       [2.47391987],\n",
       "       [2.53666425],\n",
       "       [2.53666425],\n",
       "       [2.53666425],\n",
       "       [2.50977373],\n",
       "       [2.42013907],\n",
       "       [2.42013907],\n",
       "       [2.42013907],\n",
       "       [2.42013907],\n",
       "       [2.25879622],\n",
       "       [2.25879622],\n",
       "       [2.16916156],\n",
       "       [2.16916156],\n",
       "       [2.16916156],\n",
       "       [2.16916156],\n",
       "       [2.16916156],\n",
       "       [2.16916156],\n",
       "       [2.16916156],\n",
       "       [1.95224535],\n",
       "       [1.95224535],\n",
       "       [2.09371257],\n",
       "       [2.09371257],\n",
       "       [2.09371257],\n",
       "       [2.0276947 ],\n",
       "       [2.13143706],\n",
       "       [2.13143706],\n",
       "       [2.13143706],\n",
       "       [2.0276947 ],\n",
       "       [2.0276947 ],\n",
       "       [2.0276947 ],\n",
       "       [1.99940097],\n",
       "       [1.99940097],\n",
       "       [1.99940097],\n",
       "       [1.99940097],\n",
       "       [1.99940097],\n",
       "       [1.99940097],\n",
       "       [2.23517942],\n",
       "       [2.23517942],\n",
       "       [2.23517942],\n",
       "       [2.32005978],\n",
       "       [2.36721539],\n",
       "       [2.36721539],\n",
       "       [2.36721539],\n",
       "       [2.36721539],\n",
       "       [2.36721539],\n",
       "       [2.36721539],\n",
       "       [2.36721539],\n",
       "       [2.36721539],\n",
       "       [2.36721539],\n",
       "       [2.4332335 ],\n",
       "       [2.33892202],\n",
       "       [2.33892202],\n",
       "       [2.33892202],\n",
       "       [2.33892202],\n",
       "       [2.32005978],\n",
       "       [2.32005978],\n",
       "       [2.32005978],\n",
       "       [2.31062865],\n",
       "       [2.65958071],\n",
       "       [2.45209575],\n",
       "       [2.74446106],\n",
       "       [2.74446106],\n",
       "       [2.74446106],\n",
       "       [2.8010478 ],\n",
       "       [2.88592792],\n",
       "       [2.96137714],\n",
       "       [2.75389218],\n",
       "       [2.75389218],\n",
       "       [2.75389218],\n",
       "       [2.65958071],\n",
       "       [2.65958071],\n",
       "       [2.58413172],\n",
       "       [2.58413172],\n",
       "       [2.51811385],\n",
       "       [2.51811385],\n",
       "       [2.51811385],\n",
       "       [2.54640722],\n",
       "       [2.4992516 ],\n",
       "       [2.4992516 ],\n",
       "       [2.57470059],\n",
       "       [2.57470059],\n",
       "       [2.57470059],\n",
       "       [2.57470059],\n",
       "       [2.65958071],\n",
       "       [2.72559881],\n",
       "       [2.60299397],\n",
       "       [2.60299397],\n",
       "       [2.60299397],\n",
       "       [2.6973052 ],\n",
       "       [2.6973052 ],\n",
       "       [2.76332331],\n",
       "       [2.6973052 ],\n",
       "       [2.6973052 ],\n",
       "       [2.6973052 ],\n",
       "       [2.6973052 ],\n",
       "       [2.6973052 ],\n",
       "       [2.6973052 ],\n",
       "       [2.6973052 ],\n",
       "       [2.6973052 ],\n",
       "       [2.6973052 ],\n",
       "       [2.71616769],\n",
       "       [2.90479016],\n",
       "       [2.90479016],\n",
       "       [3.18772459],\n",
       "       [3.01796412],\n",
       "       [3.01796412],\n",
       "       [3.03682637],\n",
       "       [2.91422129],\n",
       "       [2.91422129],\n",
       "       [2.91422129],\n",
       "       [2.95194602],\n",
       "       [2.92365241],\n",
       "       [2.89535904],\n",
       "       [2.89535904],\n",
       "       [2.89535904],\n",
       "       [2.93308353],\n",
       "       [2.93308353],\n",
       "       [2.87649679],\n",
       "       [2.87649679],\n",
       "       [3.008533  ],\n",
       "       [2.92365241],\n",
       "       [2.92365241],\n",
       "       [2.84820342],\n",
       "       [2.68787408],\n",
       "       [2.62185621],\n",
       "       [2.76332331],\n",
       "       [2.73502994],\n",
       "       [2.73502994],\n",
       "       [2.63128734],\n",
       "       [2.63128734],\n",
       "       [2.63128734],\n",
       "       [2.63128734],\n",
       "       [2.64071846],\n",
       "       [2.78218555],\n",
       "       [2.67844296],\n",
       "       [2.64071846],\n",
       "       [2.65958071],\n",
       "       [2.65958071],\n",
       "       [2.65958071],\n",
       "       [2.64071846],\n",
       "       [2.64071846],\n",
       "       [2.59356284],\n",
       "       [2.67844296],\n",
       "       [2.68787408],\n",
       "       [2.68787408],\n",
       "       [2.51811385],\n",
       "       [2.51811385],\n",
       "       [2.50868273],\n",
       "       [2.37664652],\n",
       "       [2.37664652],\n",
       "       [2.35778427],\n",
       "       [2.29176641],\n",
       "       [2.2257483 ],\n",
       "       [2.0654192 ],\n",
       "       [2.0276947 ],\n",
       "       [2.0276947 ],\n",
       "       [2.04655695],\n",
       "       [1.9711076 ],\n",
       "       [1.9711076 ],\n",
       "       [1.74476039],\n",
       "       [1.73532927],\n",
       "       [1.75419164],\n",
       "       [1.48068857],\n",
       "       [1.52784431],\n",
       "       [1.18832326],\n",
       "       [1.48068857],\n",
       "       [1.41467059],\n",
       "       [1.27320361],\n",
       "       [1.36751497],\n",
       "       [1.14116764],\n",
       "       [1.14116764],\n",
       "       [1.57499993],\n",
       "       [1.59000003],\n",
       "       [1.5       ],\n",
       "       [1.40999997],\n",
       "       [1.40999997],\n",
       "       [1.27999997],\n",
       "       [1.27999997],\n",
       "       [1.27999997],\n",
       "       [1.30999994],\n",
       "       [1.30999994],\n",
       "       [1.44000006],\n",
       "       [1.54999995],\n",
       "       [1.51999998],\n",
       "       [1.45000005],\n",
       "       [1.32000005],\n",
       "       [1.33000004],\n",
       "       [1.35000002],\n",
       "       [1.33000004],\n",
       "       [1.23000002],\n",
       "       [1.25      ],\n",
       "       [1.26999998],\n",
       "       [1.26999998],\n",
       "       [1.24000001],\n",
       "       [1.42999995],\n",
       "       [1.48000002],\n",
       "       [1.32000005],\n",
       "       [1.44000006],\n",
       "       [1.32000005],\n",
       "       [1.32000005],\n",
       "       [1.34000003],\n",
       "       [1.34000003],\n",
       "       [1.34000003],\n",
       "       [1.38      ],\n",
       "       [1.30999994],\n",
       "       [1.28999996],\n",
       "       [1.33000004],\n",
       "       [1.29999995],\n",
       "       [1.29999995],\n",
       "       [1.29999995],\n",
       "       [1.29999995],\n",
       "       [1.20000005],\n",
       "       [1.20000005],\n",
       "       [1.20000005],\n",
       "       [1.41999996],\n",
       "       [1.46000004],\n",
       "       [1.46000004],\n",
       "       [1.44000006],\n",
       "       [1.45000005],\n",
       "       [1.45000005],\n",
       "       [1.45000005],\n",
       "       [1.71000004],\n",
       "       [1.83000004],\n",
       "       [1.67999995],\n",
       "       [1.63999999],\n",
       "       [1.5       ],\n",
       "       [1.48000002],\n",
       "       [1.48000002],\n",
       "       [1.48000002],\n",
       "       [1.50999999],\n",
       "       [1.51999998],\n",
       "       [1.50999999],\n",
       "       [1.50999999],\n",
       "       [1.50999999],\n",
       "       [1.50999999],\n",
       "       [1.50999999],\n",
       "       [1.50999999],\n",
       "       [1.50999999],\n",
       "       [1.47000003],\n",
       "       [1.47000003],\n",
       "       [1.55999994],\n",
       "       [1.53999996],\n",
       "       [1.50999999],\n",
       "       [1.50999999],\n",
       "       [1.50999999],\n",
       "       [1.50999999],\n",
       "       [1.50999999],\n",
       "       [1.50999999],\n",
       "       [1.53999996],\n",
       "       [1.53999996],\n",
       "       [1.53999996],\n",
       "       [1.50999999],\n",
       "       [1.50999999],\n",
       "       [1.53999996],\n",
       "       [1.53999996],\n",
       "       [1.54999995],\n",
       "       [1.54999995],\n",
       "       [1.41999996],\n",
       "       [1.41999996],\n",
       "       [1.41999996],\n",
       "       [1.41999996],\n",
       "       [1.38      ],\n",
       "       [1.38      ],\n",
       "       [1.38      ],\n",
       "       [1.38      ],\n",
       "       [1.38      ],\n",
       "       [1.38      ],\n",
       "       [1.54999995],\n",
       "       [1.54999995],\n",
       "       [1.45000005],\n",
       "       [1.41999996],\n",
       "       [1.50999999],\n",
       "       [1.39999998],\n",
       "       [1.46000004],\n",
       "       [1.47000003],\n",
       "       [1.47000003],\n",
       "       [1.45000005],\n",
       "       [1.40999997],\n",
       "       [1.40999997],\n",
       "       [1.40999997],\n",
       "       [1.40999997],\n",
       "       [1.40999997],\n",
       "       [1.44000006],\n",
       "       [1.44000006],\n",
       "       [1.44000006],\n",
       "       [1.41999996],\n",
       "       [1.28999996],\n",
       "       [1.30999994],\n",
       "       [1.30999994],\n",
       "       [1.30999994],\n",
       "       [1.34000003],\n",
       "       [1.30999994],\n",
       "       [1.30999994],\n",
       "       [1.30999994],\n",
       "       [1.25      ],\n",
       "       [1.20000005],\n",
       "       [1.20000005],\n",
       "       [1.20000005],\n",
       "       [1.25999999],\n",
       "       [1.25999999],\n",
       "       [1.25999999],\n",
       "       [1.25999999],\n",
       "       [1.25999999],\n",
       "       [1.36000001],\n",
       "       [1.36000001],\n",
       "       [1.36000001],\n",
       "       [1.40999997],\n",
       "       [1.40999997],\n",
       "       [1.46000004],\n",
       "       [1.46000004],\n",
       "       [1.46000004],\n",
       "       [1.39999998],\n",
       "       [1.39999998],\n",
       "       [1.39999998],\n",
       "       [1.46000004],\n",
       "       [1.46000004],\n",
       "       [1.47000003],\n",
       "       [1.50999999],\n",
       "       [1.50999999],\n",
       "       [1.60000002],\n",
       "       [1.60000002],\n",
       "       [1.60000002],\n",
       "       [1.57000005],\n",
       "       [1.50999999],\n",
       "       [1.60000002],\n",
       "       [1.60000002],\n",
       "       [1.57000005],\n",
       "       [1.64999998],\n",
       "       [1.64999998],\n",
       "       [1.64999998],\n",
       "       [1.80999994],\n",
       "       [1.87      ],\n",
       "       [1.88999999],\n",
       "       [1.88999999],\n",
       "       [1.94000006],\n",
       "       [1.91999996],\n",
       "       [1.98000002],\n",
       "       [2.00999999],\n",
       "       [2.00999999],\n",
       "       [2.00999999],\n",
       "       [2.1500001 ],\n",
       "       [2.1500001 ],\n",
       "       [2.08999991],\n",
       "       [2.08999991],\n",
       "       [2.08999991],\n",
       "       [2.19000006],\n",
       "       [2.19000006],\n",
       "       [2.28999996],\n",
       "       [2.22000003],\n",
       "       [2.19000006],\n",
       "       [2.19000006],\n",
       "       [2.24000001],\n",
       "       [2.1500001 ],\n",
       "       [2.1500001 ],\n",
       "       [2.13000011],\n",
       "       [2.16000009],\n",
       "       [2.19000006],\n",
       "       [2.20000005],\n",
       "       [2.1099999 ],\n",
       "       [1.96000004],\n",
       "       [1.96000004],\n",
       "       [2.28999996],\n",
       "       [2.21000004],\n",
       "       [2.13000011],\n",
       "       [2.22000003],\n",
       "       [2.25999999],\n",
       "       [2.28999996],\n",
       "       [2.1500001 ],\n",
       "       [2.13750005]])"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/plain": [
       "'This is scaled: '"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/plain": [
       "array([[0.03833334],\n",
       "       [0.04833334],\n",
       "       [0.05500001],\n",
       "       ...,\n",
       "       [0.39530888],\n",
       "       [0.36849235],\n",
       "       [0.366098  ]])"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/plain": [
       "'x_train: '"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/plain": [
       "array([[0.03833334, 0.04833334, 0.05500001, ..., 0.06833334, 0.07      ,\n",
       "        0.06166667],\n",
       "       [0.04833334, 0.05500001, 0.05500001, ..., 0.07      , 0.06166667,\n",
       "        0.06333332],\n",
       "       [0.05500001, 0.05500001, 0.04833334, ..., 0.06166667, 0.06333332,\n",
       "        0.06666669],\n",
       "       ...,\n",
       "       [0.52333334, 0.52500001, 0.52500001, ..., 0.48109362, 0.48613622,\n",
       "        0.49454052],\n",
       "       [0.52500001, 0.52500001, 0.52500001, ..., 0.48613622, 0.49454052,\n",
       "        0.49454052],\n",
       "       [0.52500001, 0.52500001, 0.5016667 , ..., 0.49454052, 0.49454052,\n",
       "        0.53151935]])"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/plain": [
       "'y_train: '"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/plain": [
       "array([0.06333332, 0.06666669, 0.06666669, ..., 0.49454052, 0.53151935,\n",
       "       0.51302989])"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/plain": [
       "'x_train reshaped: '"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/plain": [
       "array([[[0.03833334],\n",
       "        [0.04833334],\n",
       "        [0.05500001],\n",
       "        ...,\n",
       "        [0.06833334],\n",
       "        [0.07      ],\n",
       "        [0.06166667]],\n",
       "\n",
       "       [[0.04833334],\n",
       "        [0.05500001],\n",
       "        [0.05500001],\n",
       "        ...,\n",
       "        [0.07      ],\n",
       "        [0.06166667],\n",
       "        [0.06333332]],\n",
       "\n",
       "       [[0.05500001],\n",
       "        [0.05500001],\n",
       "        [0.04833334],\n",
       "        ...,\n",
       "        [0.06166667],\n",
       "        [0.06333332],\n",
       "        [0.06666669]],\n",
       "\n",
       "       ...,\n",
       "\n",
       "       [[0.52333334],\n",
       "        [0.52500001],\n",
       "        [0.52500001],\n",
       "        ...,\n",
       "        [0.48109362],\n",
       "        [0.48613622],\n",
       "        [0.49454052]],\n",
       "\n",
       "       [[0.52500001],\n",
       "        [0.52500001],\n",
       "        [0.52500001],\n",
       "        ...,\n",
       "        [0.48613622],\n",
       "        [0.49454052],\n",
       "        [0.49454052]],\n",
       "\n",
       "       [[0.52500001],\n",
       "        [0.52500001],\n",
       "        [0.5016667 ],\n",
       "        ...,\n",
       "        [0.49454052],\n",
       "        [0.49454052],\n",
       "        [0.53151935]]])"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Epoch 1/1\n",
      " - 648s - loss: 0.0026\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "'This is closing price: '"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/plain": [
       "array([[2.9570932],\n",
       "       [2.98586  ],\n",
       "       [3.0046563],\n",
       "       [2.9992425],\n",
       "       [2.98431  ],\n",
       "       [2.9675734],\n",
       "       [2.9531186],\n",
       "       [2.9425597],\n",
       "       [2.9360209],\n",
       "       [2.913753 ],\n",
       "       [2.9018238],\n",
       "       [2.901632 ],\n",
       "       [2.8827338],\n",
       "       [2.860277 ],\n",
       "       [2.8507307],\n",
       "       [2.8485332],\n",
       "       [2.8383174],\n",
       "       [2.8270273],\n",
       "       [2.8173108],\n",
       "       [2.810111 ],\n",
       "       [2.791694 ],\n",
       "       [2.772138 ],\n",
       "       [2.7555275],\n",
       "       [2.7432783],\n",
       "       [2.7165933],\n",
       "       [2.6856337],\n",
       "       [2.678653 ],\n",
       "       [2.661112 ],\n",
       "       [2.6751513],\n",
       "       [2.6998127],\n",
       "       [2.7336152],\n",
       "       [2.7547429],\n",
       "       [2.766354 ],\n",
       "       [2.7916086],\n",
       "       [2.8171978],\n",
       "       [2.8345308],\n",
       "       [2.844693 ],\n",
       "       [2.8493273],\n",
       "       [2.8554811],\n",
       "       [2.8108063],\n",
       "       [2.750199 ],\n",
       "       [2.6664207],\n",
       "       [2.5855203],\n",
       "       [2.5209956],\n",
       "       [2.4761224],\n",
       "       [2.4655058],\n",
       "       [2.4693944],\n",
       "       [2.4801242],\n",
       "       [2.492422 ],\n",
       "       [2.4883387],\n",
       "       [2.5076902],\n",
       "       [2.5329351],\n",
       "       [2.5177884],\n",
       "       [2.4878619],\n",
       "       [2.4557874],\n",
       "       [2.3952267],\n",
       "       [2.3563027],\n",
       "       [2.3331375],\n",
       "       [2.3215866],\n",
       "       [2.3176713],\n",
       "       [2.3197608],\n",
       "       [2.3193617],\n",
       "       [2.3261654],\n",
       "       [2.3264983],\n",
       "       [2.3239105],\n",
       "       [2.3299658],\n",
       "       [2.3236716],\n",
       "       [2.3261993],\n",
       "       [2.3447628],\n",
       "       [2.3669624],\n",
       "       [2.3868558],\n",
       "       [2.4151974],\n",
       "       [2.4417024],\n",
       "       [2.462433 ],\n",
       "       [2.4765077],\n",
       "       [2.4847038],\n",
       "       [2.4884853],\n",
       "       [2.4893992],\n",
       "       [2.488761 ],\n",
       "       [2.4875367],\n",
       "       [2.5416963],\n",
       "       [2.6100466],\n",
       "       [2.6731403],\n",
       "       [2.7222931],\n",
       "       [2.7746804],\n",
       "       [2.8177369],\n",
       "       [2.8482573],\n",
       "       [2.8600738],\n",
       "       [2.8611827],\n",
       "       [2.8448956],\n",
       "       [2.836405 ],\n",
       "       [2.8326502],\n",
       "       [2.8322177],\n",
       "       [2.8338857],\n",
       "       [2.8366995],\n",
       "       [2.8399749],\n",
       "       [2.8311827],\n",
       "       [2.800509 ],\n",
       "       [2.766608 ],\n",
       "       [2.7359102],\n",
       "       [2.7484782],\n",
       "       [2.7792585],\n",
       "       [2.8133836],\n",
       "       [2.8430524],\n",
       "       [2.8651633],\n",
       "       [2.879487 ],\n",
       "       [2.8872745],\n",
       "       [2.946171 ],\n",
       "       [3.0008726],\n",
       "       [3.0441875],\n",
       "       [3.0702167],\n",
       "       [3.063669 ],\n",
       "       [3.0440662],\n",
       "       [3.0218315],\n",
       "       [2.9955096],\n",
       "       [2.9728127],\n",
       "       [2.956325 ],\n",
       "       [2.9461956],\n",
       "       [2.9675362],\n",
       "       [2.99859  ],\n",
       "       [3.0624623],\n",
       "       [3.1246207],\n",
       "       [3.1746426],\n",
       "       [3.2231114],\n",
       "       [3.1926897],\n",
       "       [3.1356127],\n",
       "       [3.076575 ],\n",
       "       [3.0276177],\n",
       "       [2.9926991],\n",
       "       [2.9534805],\n",
       "       [2.92116  ],\n",
       "       [2.8984869],\n",
       "       [2.9256682],\n",
       "       [2.9533653],\n",
       "       [2.9775598],\n",
       "       [3.0028331],\n",
       "       [3.0269408],\n",
       "       [3.0347638],\n",
       "       [3.059013 ],\n",
       "       [3.084529 ],\n",
       "       [3.101967 ],\n",
       "       [3.1122692],\n",
       "       [3.1115563],\n",
       "       [3.1059322],\n",
       "       [3.109756 ],\n",
       "       [3.091221 ],\n",
       "       [3.0674298],\n",
       "       [3.0456793],\n",
       "       [3.0165708],\n",
       "       [2.9904861],\n",
       "       [2.9566894],\n",
       "       [2.9267325],\n",
       "       [2.9043527],\n",
       "       [2.8899157],\n",
       "       [2.8715436],\n",
       "       [2.8555226],\n",
       "       [2.843621 ],\n",
       "       [2.8253548],\n",
       "       [2.808046 ],\n",
       "       [2.794255 ],\n",
       "       [2.7793005],\n",
       "       [2.7614908],\n",
       "       [2.7648983],\n",
       "       [2.753785 ],\n",
       "       [2.7061465],\n",
       "       [2.6930964],\n",
       "       [2.6581416],\n",
       "       [2.6162016],\n",
       "       [2.5786686],\n",
       "       [2.5498624],\n",
       "       [2.540518 ],\n",
       "       [2.5415437],\n",
       "       [2.5473316],\n",
       "       [2.5542736],\n",
       "       [2.5603547],\n",
       "       [2.537399 ],\n",
       "       [2.5060108],\n",
       "       [2.475897 ],\n",
       "       [2.4515135],\n",
       "       [2.4390929],\n",
       "       [2.4460454],\n",
       "       [2.4603693],\n",
       "       [2.4756298],\n",
       "       [2.4884963],\n",
       "       [2.497733 ],\n",
       "       [2.5033574],\n",
       "       [2.5145404],\n",
       "       [2.5256972],\n",
       "       [2.53466  ],\n",
       "       [2.540796 ],\n",
       "       [2.544332 ],\n",
       "       [2.5458748],\n",
       "       [2.5461087],\n",
       "       [2.5439231],\n",
       "       [2.565081 ],\n",
       "       [2.5785308],\n",
       "       [2.5867236],\n",
       "       [2.5909405],\n",
       "       [2.5925038],\n",
       "       [2.601145 ],\n",
       "       [2.6111484],\n",
       "       [2.6287012],\n",
       "       [2.64625  ],\n",
       "       [2.6485405],\n",
       "       [2.6438806],\n",
       "       [2.6419392],\n",
       "       [2.6241133],\n",
       "       [2.603063 ],\n",
       "       [2.5963786],\n",
       "       [2.5971816],\n",
       "       [2.6016037],\n",
       "       [2.6019616],\n",
       "       [2.5835752],\n",
       "       [2.560655 ],\n",
       "       [2.5397234],\n",
       "       [2.5235448],\n",
       "       [2.4821029],\n",
       "       [2.4378974],\n",
       "       [2.3835611],\n",
       "       [2.3350403],\n",
       "       [2.297911 ],\n",
       "       [2.2728508],\n",
       "       [2.2580702],\n",
       "       [2.2508812],\n",
       "       [2.2485998],\n",
       "       [2.2092206],\n",
       "       [2.1608143],\n",
       "       [2.141847 ],\n",
       "       [2.1388786],\n",
       "       [2.1440208],\n",
       "       [2.1399832],\n",
       "       [2.1514678],\n",
       "       [2.1672966],\n",
       "       [2.182205 ],\n",
       "       [2.1747239],\n",
       "       [2.158355 ],\n",
       "       [2.1402223],\n",
       "       [2.1189816],\n",
       "       [2.0999951],\n",
       "       [2.0852592],\n",
       "       [2.0750563],\n",
       "       [2.0687757],\n",
       "       [2.0654607],\n",
       "       [2.1070418],\n",
       "       [2.1614056],\n",
       "       [2.2125654],\n",
       "       [2.2689044],\n",
       "       [2.3257177],\n",
       "       [2.371991 ],\n",
       "       [2.404613 ],\n",
       "       [2.4245071],\n",
       "       [2.434455 ],\n",
       "       [2.4376779],\n",
       "       [2.437046 ],\n",
       "       [2.4347446],\n",
       "       [2.4322233],\n",
       "       [2.4427977],\n",
       "       [2.4395192],\n",
       "       [2.4315271],\n",
       "       [2.4230094],\n",
       "       [2.4160635],\n",
       "       [2.4078612],\n",
       "       [2.4009998],\n",
       "       [2.3962595],\n",
       "       [2.3918386],\n",
       "       [2.454621 ],\n",
       "       [2.4959047],\n",
       "       [2.5779366],\n",
       "       [2.661926 ],\n",
       "       [2.7315223],\n",
       "       [2.7923334],\n",
       "       [2.8535466],\n",
       "       [2.9173186],\n",
       "       [2.9276319],\n",
       "       [2.91309  ],\n",
       "       [2.8893507],\n",
       "       [2.8471189],\n",
       "       [2.8054938],\n",
       "       [2.7575574],\n",
       "       [2.7169712],\n",
       "       [2.675187 ],\n",
       "       [2.6419141],\n",
       "       [2.6193442],\n",
       "       [2.6119509],\n",
       "       [2.6042962],\n",
       "       [2.5988147],\n",
       "       [2.6100261],\n",
       "       [2.6264906],\n",
       "       [2.6425223],\n",
       "       [2.655336 ],\n",
       "       [2.680496 ],\n",
       "       [2.7186377],\n",
       "       [2.7311227],\n",
       "       [2.7302027],\n",
       "       [2.7226992],\n",
       "       [2.7314746],\n",
       "       [2.7451053],\n",
       "       [2.7714033],\n",
       "       [2.7851593],\n",
       "       [2.7911828],\n",
       "       [2.7923663],\n",
       "       [2.7910023],\n",
       "       [2.788691 ],\n",
       "       [2.7864122],\n",
       "       [2.7846658],\n",
       "       [2.7836177],\n",
       "       [2.7832355],\n",
       "       [2.7870755],\n",
       "       [2.829214 ],\n",
       "       [2.8798583],\n",
       "       [2.9821098],\n",
       "       [3.0523925],\n",
       "       [3.096326 ],\n",
       "       [3.1229591],\n",
       "       [3.1108723],\n",
       "       [3.0842566],\n",
       "       [3.055655 ],\n",
       "       [3.039095 ],\n",
       "       [3.0253723],\n",
       "       [3.0106883],\n",
       "       [2.9991343],\n",
       "       [2.9916751],\n",
       "       [2.9955142],\n",
       "       [3.003904 ],\n",
       "       [3.0019464],\n",
       "       [2.9964628],\n",
       "       [3.0168476],\n",
       "       [3.027081 ],\n",
       "       [3.031819 ],\n",
       "       [3.0179682],\n",
       "       [2.9670446],\n",
       "       [2.8973007],\n",
       "       [2.860083 ],\n",
       "       [2.8377457],\n",
       "       [2.8271399],\n",
       "       [2.804024 ],\n",
       "       [2.7806604],\n",
       "       [2.7614942],\n",
       "       [2.7478256],\n",
       "       [2.7410657],\n",
       "       [2.7661777],\n",
       "       [2.7799504],\n",
       "       [2.779546 ],\n",
       "       [2.7763166],\n",
       "       [2.771776 ],\n",
       "       [2.7671356],\n",
       "       [2.7593515],\n",
       "       [2.75149  ],\n",
       "       [2.735673 ],\n",
       "       [2.7358534],\n",
       "       [2.7443428],\n",
       "       [2.7550988],\n",
       "       [2.7319036],\n",
       "       [2.6988053],\n",
       "       [2.6650903],\n",
       "       [2.611988 ],\n",
       "       [2.5608647],\n",
       "       [2.5163352],\n",
       "       [2.4708073],\n",
       "       [2.4214356],\n",
       "       [2.3501155],\n",
       "       [2.2758107],\n",
       "       [2.2134874],\n",
       "       [2.1711624],\n",
       "       [2.1319845],\n",
       "       [2.101756 ],\n",
       "       [2.0404437],\n",
       "       [1.974868 ],\n",
       "       [1.9215093],\n",
       "       [1.8349825],\n",
       "       [1.7571088],\n",
       "       [1.638177 ],\n",
       "       [1.5702862],\n",
       "       [1.5250485],\n",
       "       [1.4748449],\n",
       "       [1.4465518],\n",
       "       [1.3952897],\n",
       "       [1.3419014],\n",
       "       [1.3670222],\n",
       "       [1.4274626],\n",
       "       [1.4800369],\n",
       "       [1.5046415],\n",
       "       [1.511143 ],\n",
       "       [1.4849739],\n",
       "       [1.4472369],\n",
       "       [1.4095029],\n",
       "       [1.3825241],\n",
       "       [1.3647743],\n",
       "       [1.3759419],\n",
       "       [1.4173722],\n",
       "       [1.4613873],\n",
       "       [1.4875768],\n",
       "       [1.4788   ],\n",
       "       [1.456575 ],\n",
       "       [1.4345727],\n",
       "       [1.4127272],\n",
       "       [1.3779333],\n",
       "       [1.3463713],\n",
       "       [1.3247893],\n",
       "       [1.3116004],\n",
       "       [1.2998228],\n",
       "       [1.3223436],\n",
       "       [1.3658371],\n",
       "       [1.3855948],\n",
       "       [1.4112638],\n",
       "       [1.4147109],\n",
       "       [1.4071254],\n",
       "       [1.3985614],\n",
       "       [1.3906947],\n",
       "       [1.3843828],\n",
       "       [1.3865278],\n",
       "       [1.3805592],\n",
       "       [1.3686128],\n",
       "       [1.3624686],\n",
       "       [1.3550117],\n",
       "       [1.3483151],\n",
       "       [1.343122 ],\n",
       "       [1.33955  ],\n",
       "       [1.3208026],\n",
       "       [1.2981633],\n",
       "       [1.2772976],\n",
       "       [1.2970184],\n",
       "       [1.3394626],\n",
       "       [1.3861921],\n",
       "       [1.4239985],\n",
       "       [1.4528532],\n",
       "       [1.4723153],\n",
       "       [1.4837592],\n",
       "       [1.5337026],\n",
       "       [1.6138524],\n",
       "       [1.6686164],\n",
       "       [1.6954443],\n",
       "       [1.6797687],\n",
       "       [1.6435211],\n",
       "       [1.6035602],\n",
       "       [1.5686233],\n",
       "       [1.5473117],\n",
       "       [1.5380317],\n",
       "       [1.5347757],\n",
       "       [1.5354204],\n",
       "       [1.538175 ],\n",
       "       [1.5417507],\n",
       "       [1.5453148],\n",
       "       [1.5483999],\n",
       "       [1.5508049],\n",
       "       [1.5456778],\n",
       "       [1.5379444],\n",
       "       [1.5455396],\n",
       "       [1.5554502],\n",
       "       [1.5598227],\n",
       "       [1.5608928],\n",
       "       [1.5601165],\n",
       "       [1.5585164],\n",
       "       [1.5567386],\n",
       "       [1.5551407],\n",
       "       [1.5590085],\n",
       "       [1.5647326],\n",
       "       [1.5704174],\n",
       "       [1.5699946],\n",
       "       [1.5668207],\n",
       "       [1.5679499],\n",
       "       [1.5708202],\n",
       "       [1.5757911],\n",
       "       [1.5809162],\n",
       "       [1.5630244],\n",
       "       [1.5376798],\n",
       "       [1.5129046],\n",
       "       [1.4925346],\n",
       "       [1.4709916],\n",
       "       [1.4527196],\n",
       "       [1.4391187],\n",
       "       [1.430101 ],\n",
       "       [1.4248548],\n",
       "       [1.4223391],\n",
       "       [1.4502103],\n",
       "       [1.4876771],\n",
       "       [1.506619 ],\n",
       "       [1.5086113],\n",
       "       [1.5172453],\n",
       "       [1.5083104],\n",
       "       [1.5029169],\n",
       "       [1.5013909],\n",
       "       [1.5018952],\n",
       "       [1.499887 ],\n",
       "       [1.4903032],\n",
       "       [1.4788274],\n",
       "       [1.4683387],\n",
       "       [1.4601008],\n",
       "       [1.4543735],\n",
       "       [1.4559354],\n",
       "       [1.460714 ],\n",
       "       [1.4663279],\n",
       "       [1.4680622],\n",
       "       [1.4458011],\n",
       "       [1.4195215],\n",
       "       [1.395453 ],\n",
       "       [1.3764057],\n",
       "       [1.3679487],\n",
       "       [1.3609653],\n",
       "       [1.3560195],\n",
       "       [1.3528851],\n",
       "       [1.341167 ],\n",
       "       [1.3191177],\n",
       "       [1.2957673],\n",
       "       [1.2755033],\n",
       "       [1.2698456],\n",
       "       [1.272005 ],\n",
       "       [1.277636 ],\n",
       "       [1.2840067],\n",
       "       [1.2896202],\n",
       "       [1.31042  ],\n",
       "       [1.3348138],\n",
       "       [1.3568898],\n",
       "       [1.3824577],\n",
       "       [1.4051768],\n",
       "       [1.4310608],\n",
       "       [1.4538612],\n",
       "       [1.4712629],\n",
       "       [1.4728438],\n",
       "       [1.466671 ],\n",
       "       [1.4576995],\n",
       "       [1.45902  ],\n",
       "       [1.4649392],\n",
       "       [1.4739674],\n",
       "       [1.4899174],\n",
       "       [1.506556 ],\n",
       "       [1.5363033],\n",
       "       [1.5671859],\n",
       "       [1.593572 ],\n",
       "       [1.6082023],\n",
       "       [1.6044774],\n",
       "       [1.6082952],\n",
       "       [1.6146469],\n",
       "       [1.6160827],\n",
       "       [1.6289845],\n",
       "       [1.6449705],\n",
       "       [1.6599246],\n",
       "       [1.6999068],\n",
       "       [1.7551829],\n",
       "       [1.8119462],\n",
       "       [1.859711 ],\n",
       "       [1.9038578],\n",
       "       [1.9346344],\n",
       "       [1.9645203],\n",
       "       [1.9937524],\n",
       "       [2.0173955],\n",
       "       [2.0342984],\n",
       "       [2.0706737],\n",
       "       [2.1092153],\n",
       "       [2.1312695],\n",
       "       [2.1422236],\n",
       "       [2.1461024],\n",
       "       [2.1645257],\n",
       "       [2.1861422],\n",
       "       [2.2243907],\n",
       "       [2.2503436],\n",
       "       [2.2611327],\n",
       "       [2.2632167],\n",
       "       [2.270241 ],\n",
       "       [2.261416 ],\n",
       "       [2.2476492],\n",
       "       [2.2304773],\n",
       "       [2.2206717],\n",
       "       [2.221663 ],\n",
       "       [2.2295554],\n",
       "       [2.2229655],\n",
       "       [2.1841264],\n",
       "       [2.13822  ],\n",
       "       [2.1571543],\n",
       "       [2.186821 ],\n",
       "       [2.2027507],\n",
       "       [2.2266815],\n",
       "       [2.2568836],\n",
       "       [2.2899902],\n",
       "       [2.292162 ]], dtype=float32)"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "0.13140250718243074\n",
      "(575, 1)\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/Users/giorgiobiasuzzi/opt/anaconda3/envs/MLEnvCapstone/lib/python3.7/site-packages/ipykernel_launcher.py:115: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "[<matplotlib.lines.Line2D at 0x1a5f8af2d0>,\n",
       " <matplotlib.lines.Line2D at 0x1a5f8afb50>]"
      ]
     },
     "execution_count": 10,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "import pandas as pd\n",
    "import pandas_datareader.data as web\n",
    "import numpy as np\n",
    "from sklearn.model_selection import train_test_split\n",
    "from sklearn.preprocessing import MinMaxScaler\n",
    "from keras.models import Sequential\n",
    "from keras.layers import Dense, Dropout, LSTM\n",
    "\n",
    "import matplotlib.pyplot as plt\n",
    "from matplotlib import rcParams\n",
    "import datetime as dt\n",
    "\n",
    "#Data Collection#\n",
    "stocks = ['RBSPF']\n",
    "\n",
    "start = dt.datetime(2010, 1, 1)\n",
    "end = dt.datetime(2030, 1, 27)\n",
    "\n",
    "data = web.DataReader('RBSPF', 'yahoo', start, end)\n",
    "\n",
    "#Data pre-processing#\n",
    "\n",
    "dates =[]\n",
    "for x in range(len(data)):\n",
    "    '''Remove the level index caused by the multiple layers in the original dataset'''\n",
    "    newdate = str(data.index[x])\n",
    "    newdate = newdate[0:10]\n",
    "    dates.append(newdate)\n",
    "\n",
    "data['Dates'] = dates\n",
    "data['Dates'] = pd.to_datetime(data[\"Dates\"])\n",
    "data.reset_index(drop=True, inplace=True)\n",
    "#data['Dates'] = (data['Dates'] - data['Dates'].min()) / np.timedelta64(1,'D')\n",
    "data = data.drop(data.columns[[0, 1, 2, 3, 4]], axis=1)\n",
    "data = data[['Dates', 'Adj Close']]\n",
    "display(data)\n",
    "\n",
    "for i in range(0,len(data)):\n",
    "    data['Dates'][i] = data['Dates'][i]\n",
    "    data['Adj Close'][i] = data['Adj Close'][i]\n",
    "\n",
    "#Setting Index\n",
    "data.index = data.Dates\n",
    "data.drop('Dates', axis=1, inplace=True)\n",
    "\n",
    "\n",
    "#Creating train and test sets\n",
    "dataset = data.values\n",
    "display(dataset)\n",
    "print(dataset.shape)\n",
    "\n",
    "train = dataset[0:2196,:]\n",
    "valid = dataset[2196:,:]\n",
    "display(train)\n",
    "display(valid)\n",
    "\n",
    "#Converting dataset into x_train and y_train\n",
    "scaler = MinMaxScaler(feature_range=(0, 1))\n",
    "scaled_Data = scaler.fit_transform(dataset)\n",
    "display('This is scaled: ', scaled_Data)\n",
    "\n",
    "\n",
    "x_train, y_train = [], []\n",
    "for i in range(60,len(train)):\n",
    "    x_train.append(scaled_Data[i-60:i,0])\n",
    "    y_train.append(scaled_Data[i,0])\n",
    "x_train, y_train = np.array(x_train), np.array(y_train)\n",
    "\n",
    "display('x_train: ', x_train)\n",
    "display('y_train: ', y_train)\n",
    "\n",
    "x_train = np.reshape(x_train, (x_train.shape[0],x_train.shape[1],1))\n",
    "display('x_train reshaped: ', x_train)\n",
    "\n",
    "# create and fit the LSTM network\n",
    "model = Sequential()\n",
    "model.add(LSTM(units=50, return_sequences=True, input_shape=(x_train.shape[1],1)))\n",
    "model.add(LSTM(units=50))\n",
    "model.add(Dense(1))\n",
    "\n",
    "model.compile(loss='mean_squared_error', optimizer='adam')\n",
    "model.fit(x_train, y_train, epochs=1, batch_size=1, verbose=2)\n",
    "\n",
    "\n",
    "#predicting 246 values, using past 60 from the train data\n",
    "inputs = data[len(data) - len(valid) - 60:].values\n",
    "inputs = inputs.reshape(-1,1)\n",
    "inputs  = scaler.transform(inputs)\n",
    "\n",
    "X_test = []\n",
    "for i in range(60,inputs.shape[0]):\n",
    "    X_test.append(inputs[i-60:i,0])\n",
    "X_test = np.array(X_test)\n",
    "\n",
    "X_test = np.reshape(X_test, (X_test.shape[0],X_test.shape[1],1))\n",
    "closing_price = model.predict(X_test)\n",
    "closing_price = scaler.inverse_transform(closing_price)\n",
    "\n",
    "display('This is closing price: ', closing_price)\n",
    "\n",
    "rms=np.sqrt(np.mean(np.power((valid-closing_price),2)))\n",
    "print(rms)\n",
    "\n",
    "\n",
    "dfClosing_Price = pd.DataFrame(closing_price, columns=[\"Predictions\"])\n",
    "\n",
    "#for plotting\n",
    "train = data[:2196]\n",
    "valid = data[2196:]\n",
    "print(closing_price.shape)\n",
    "\n",
    "valid['Predictions'] = closing_price\n",
    "plt.plot(train['Adj Close'])\n",
    "plt.plot(valid[['Adj Close','Predictions']])"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.7.9"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 4
}
