{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 12,
   "metadata": {
    "scrolled": false
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Dates</th>\n",
       "      <th>Adj Close</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>2010-01-04</td>\n",
       "      <td>0.426354</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2010-01-05</td>\n",
       "      <td>0.478560</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>2010-01-06</td>\n",
       "      <td>0.513364</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>2010-01-07</td>\n",
       "      <td>0.513364</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>2010-01-08</td>\n",
       "      <td>0.478560</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2751</th>\n",
       "      <td>2020-12-07</td>\n",
       "      <td>2.190000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2752</th>\n",
       "      <td>2020-12-08</td>\n",
       "      <td>2.190000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2753</th>\n",
       "      <td>2020-12-09</td>\n",
       "      <td>2.240000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2754</th>\n",
       "      <td>2020-12-10</td>\n",
       "      <td>2.150000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2755</th>\n",
       "      <td>2020-12-11</td>\n",
       "      <td>2.150000</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>2756 rows Ã— 2 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "          Dates  Adj Close\n",
       "0    2010-01-04   0.426354\n",
       "1    2010-01-05   0.478560\n",
       "2    2010-01-06   0.513364\n",
       "3    2010-01-07   0.513364\n",
       "4    2010-01-08   0.478560\n",
       "...         ...        ...\n",
       "2751 2020-12-07   2.190000\n",
       "2752 2020-12-08   2.190000\n",
       "2753 2020-12-09   2.240000\n",
       "2754 2020-12-10   2.150000\n",
       "2755 2020-12-11   2.150000\n",
       "\n",
       "[2756 rows x 2 columns]"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/Users/giorgiobiasuzzi/opt/anaconda3/envs/MLEnvCapstone/lib/python3.7/site-packages/ipykernel_launcher.py:39: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "/Users/giorgiobiasuzzi/opt/anaconda3/envs/MLEnvCapstone/lib/python3.7/site-packages/ipykernel_launcher.py:40: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "array([[0.42635357],\n",
       "       [0.47856012],\n",
       "       [0.51336449],\n",
       "       ...,\n",
       "       [2.24000001],\n",
       "       [2.1500001 ],\n",
       "       [2.1500001 ]])"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "(2756, 1)\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "array([[0.42635357],\n",
       "       [0.47856012],\n",
       "       [0.51336449],\n",
       "       ...,\n",
       "       [2.80805421],\n",
       "       [3.00110793],\n",
       "       [2.90458083]])"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/plain": [
       "array([[2.9221313 ],\n",
       "       [2.9221313 ],\n",
       "       [2.84315491],\n",
       "       [2.84315491],\n",
       "       [2.84315491],\n",
       "       [2.84315491],\n",
       "       [2.84315491],\n",
       "       [2.84315491],\n",
       "       [2.74662805],\n",
       "       [2.80805421],\n",
       "       [2.83437991],\n",
       "       [2.71152711],\n",
       "       [2.71152711],\n",
       "       [2.76417828],\n",
       "       [2.76417828],\n",
       "       [2.70275187],\n",
       "       [2.70275187],\n",
       "       [2.70275187],\n",
       "       [2.70275187],\n",
       "       [2.63255048],\n",
       "       [2.63255048],\n",
       "       [2.63255048],\n",
       "       [2.63255048],\n",
       "       [2.53602409],\n",
       "       [2.51847339],\n",
       "       [2.62377572],\n",
       "       [2.50969839],\n",
       "       [2.67642641],\n",
       "       [2.67642641],\n",
       "       [2.7203021 ],\n",
       "       [2.66765118],\n",
       "       [2.66765118],\n",
       "       [2.77295375],\n",
       "       [2.77295375],\n",
       "       [2.75540304],\n",
       "       [2.75540304],\n",
       "       [2.75540304],\n",
       "       [2.78172874],\n",
       "       [2.52724886],\n",
       "       [2.50969839],\n",
       "       [2.3692956 ],\n",
       "       [2.35174537],\n",
       "       [2.35174537],\n",
       "       [2.35174537],\n",
       "       [2.43949699],\n",
       "       [2.42194676],\n",
       "       [2.42194676],\n",
       "       [2.42194676],\n",
       "       [2.34297037],\n",
       "       [2.50092316],\n",
       "       [2.50092316],\n",
       "       [2.29909444],\n",
       "       [2.29909444],\n",
       "       [2.29909444],\n",
       "       [2.12359095],\n",
       "       [2.24644327],\n",
       "       [2.24644327],\n",
       "       [2.24644327],\n",
       "       [2.24644327],\n",
       "       [2.25521851],\n",
       "       [2.2288928 ],\n",
       "       [2.27276897],\n",
       "       [2.2288928 ],\n",
       "       [2.2288928 ],\n",
       "       [2.28154397],\n",
       "       [2.20256734],\n",
       "       [2.27276897],\n",
       "       [2.34297037],\n",
       "       [2.34297037],\n",
       "       [2.34297037],\n",
       "       [2.41317153],\n",
       "       [2.41317153],\n",
       "       [2.41317153],\n",
       "       [2.41317153],\n",
       "       [2.41317153],\n",
       "       [2.41317153],\n",
       "       [2.41317153],\n",
       "       [2.41317153],\n",
       "       [2.41317153],\n",
       "       [2.70275187],\n",
       "       [2.70275187],\n",
       "       [2.70275187],\n",
       "       [2.70275187],\n",
       "       [2.79927921],\n",
       "       [2.79927921],\n",
       "       [2.79927921],\n",
       "       [2.76417828],\n",
       "       [2.76417828],\n",
       "       [2.70275187],\n",
       "       [2.76417828],\n",
       "       [2.76417828],\n",
       "       [2.76417828],\n",
       "       [2.76417828],\n",
       "       [2.76417828],\n",
       "       [2.76417828],\n",
       "       [2.70275187],\n",
       "       [2.60622525],\n",
       "       [2.60622525],\n",
       "       [2.59745026],\n",
       "       [2.78172874],\n",
       "       [2.79050398],\n",
       "       [2.79050398],\n",
       "       [2.79050398],\n",
       "       [2.79050398],\n",
       "       [2.79050398],\n",
       "       [2.79050398],\n",
       "       [3.07130909],\n",
       "       [3.00110793],\n",
       "       [3.00110793],\n",
       "       [2.98355746],\n",
       "       [2.88703084],\n",
       "       [2.88703084],\n",
       "       [2.88703084],\n",
       "       [2.85193014],\n",
       "       [2.85193014],\n",
       "       [2.85193014],\n",
       "       [2.85193014],\n",
       "       [2.98355746],\n",
       "       [2.98355746],\n",
       "       [3.15028572],\n",
       "       [3.13273525],\n",
       "       [3.13273525],\n",
       "       [3.19996142],\n",
       "       [2.86831307],\n",
       "       [2.86831307],\n",
       "       [2.86831307],\n",
       "       [2.86831307],\n",
       "       [2.86831307],\n",
       "       [2.77867794],\n",
       "       [2.77867794],\n",
       "       [2.77867794],\n",
       "       [2.98483801],\n",
       "       [2.90416694],\n",
       "       [2.90416694],\n",
       "       [2.9400208 ],\n",
       "       [2.95794773],\n",
       "       [2.90416694],\n",
       "       [3.02965569],\n",
       "       [3.02965569],\n",
       "       [3.01172853],\n",
       "       [3.01172853],\n",
       "       [2.98483801],\n",
       "       [2.98483801],\n",
       "       [3.03861904],\n",
       "       [2.91313028],\n",
       "       [2.91313028],\n",
       "       [2.91313028],\n",
       "       [2.85038614],\n",
       "       [2.85038614],\n",
       "       [2.77867794],\n",
       "       [2.77867794],\n",
       "       [2.77867794],\n",
       "       [2.77867794],\n",
       "       [2.72489715],\n",
       "       [2.72489715],\n",
       "       [2.72489715],\n",
       "       [2.67111635],\n",
       "       [2.67111635],\n",
       "       [2.67111635],\n",
       "       [2.64422584],\n",
       "       [2.61733556],\n",
       "       [2.71593356],\n",
       "       [2.59940863],\n",
       "       [2.42910266],\n",
       "       [2.64422584],\n",
       "       [2.44702959],\n",
       "       [2.42013907],\n",
       "       [2.42013907],\n",
       "       [2.42013907],\n",
       "       [2.47391987],\n",
       "       [2.47391987],\n",
       "       [2.47391987],\n",
       "       [2.47391987],\n",
       "       [2.47391987],\n",
       "       [2.33050418],\n",
       "       [2.33050418],\n",
       "       [2.33050418],\n",
       "       [2.33050418],\n",
       "       [2.35739493],\n",
       "       [2.42013907],\n",
       "       [2.42013907],\n",
       "       [2.42013907],\n",
       "       [2.42013907],\n",
       "       [2.42013907],\n",
       "       [2.42013907],\n",
       "       [2.46495652],\n",
       "       [2.46495652],\n",
       "       [2.46495652],\n",
       "       [2.46495652],\n",
       "       [2.46495652],\n",
       "       [2.46495652],\n",
       "       [2.46495652],\n",
       "       [2.45599294],\n",
       "       [2.5814817 ],\n",
       "       [2.50977373],\n",
       "       [2.50977373],\n",
       "       [2.50977373],\n",
       "       [2.50977373],\n",
       "       [2.55459118],\n",
       "       [2.55459118],\n",
       "       [2.59940863],\n",
       "       [2.59940863],\n",
       "       [2.53666425],\n",
       "       [2.53666425],\n",
       "       [2.56355453],\n",
       "       [2.47391987],\n",
       "       [2.47391987],\n",
       "       [2.53666425],\n",
       "       [2.53666425],\n",
       "       [2.53666425],\n",
       "       [2.50977373],\n",
       "       [2.42013907],\n",
       "       [2.42013907],\n",
       "       [2.42013907],\n",
       "       [2.42013907],\n",
       "       [2.25879622],\n",
       "       [2.25879622],\n",
       "       [2.16916156],\n",
       "       [2.16916156],\n",
       "       [2.16916156],\n",
       "       [2.16916156],\n",
       "       [2.16916156],\n",
       "       [2.16916156],\n",
       "       [2.16916156],\n",
       "       [1.95224535],\n",
       "       [1.95224535],\n",
       "       [2.09371257],\n",
       "       [2.09371257],\n",
       "       [2.09371257],\n",
       "       [2.0276947 ],\n",
       "       [2.13143706],\n",
       "       [2.13143706],\n",
       "       [2.13143706],\n",
       "       [2.0276947 ],\n",
       "       [2.0276947 ],\n",
       "       [2.0276947 ],\n",
       "       [1.99940097],\n",
       "       [1.99940097],\n",
       "       [1.99940097],\n",
       "       [1.99940097],\n",
       "       [1.99940097],\n",
       "       [1.99940097],\n",
       "       [2.23517942],\n",
       "       [2.23517942],\n",
       "       [2.23517942],\n",
       "       [2.32005978],\n",
       "       [2.36721539],\n",
       "       [2.36721539],\n",
       "       [2.36721539],\n",
       "       [2.36721539],\n",
       "       [2.36721539],\n",
       "       [2.36721539],\n",
       "       [2.36721539],\n",
       "       [2.36721539],\n",
       "       [2.36721539],\n",
       "       [2.4332335 ],\n",
       "       [2.33892202],\n",
       "       [2.33892202],\n",
       "       [2.33892202],\n",
       "       [2.33892202],\n",
       "       [2.32005978],\n",
       "       [2.32005978],\n",
       "       [2.32005978],\n",
       "       [2.31062865],\n",
       "       [2.65958071],\n",
       "       [2.45209575],\n",
       "       [2.74446106],\n",
       "       [2.74446106],\n",
       "       [2.74446106],\n",
       "       [2.8010478 ],\n",
       "       [2.88592792],\n",
       "       [2.96137714],\n",
       "       [2.75389218],\n",
       "       [2.75389218],\n",
       "       [2.75389218],\n",
       "       [2.65958071],\n",
       "       [2.65958071],\n",
       "       [2.58413172],\n",
       "       [2.58413172],\n",
       "       [2.51811385],\n",
       "       [2.51811385],\n",
       "       [2.51811385],\n",
       "       [2.54640722],\n",
       "       [2.4992516 ],\n",
       "       [2.4992516 ],\n",
       "       [2.57470059],\n",
       "       [2.57470059],\n",
       "       [2.57470059],\n",
       "       [2.57470059],\n",
       "       [2.65958071],\n",
       "       [2.72559881],\n",
       "       [2.60299397],\n",
       "       [2.60299397],\n",
       "       [2.60299397],\n",
       "       [2.6973052 ],\n",
       "       [2.6973052 ],\n",
       "       [2.76332331],\n",
       "       [2.6973052 ],\n",
       "       [2.6973052 ],\n",
       "       [2.6973052 ],\n",
       "       [2.6973052 ],\n",
       "       [2.6973052 ],\n",
       "       [2.6973052 ],\n",
       "       [2.6973052 ],\n",
       "       [2.6973052 ],\n",
       "       [2.6973052 ],\n",
       "       [2.71616769],\n",
       "       [2.90479016],\n",
       "       [2.90479016],\n",
       "       [3.18772459],\n",
       "       [3.01796412],\n",
       "       [3.01796412],\n",
       "       [3.03682637],\n",
       "       [2.91422129],\n",
       "       [2.91422129],\n",
       "       [2.91422129],\n",
       "       [2.95194602],\n",
       "       [2.92365241],\n",
       "       [2.89535904],\n",
       "       [2.89535904],\n",
       "       [2.89535904],\n",
       "       [2.93308353],\n",
       "       [2.93308353],\n",
       "       [2.87649679],\n",
       "       [2.87649679],\n",
       "       [3.008533  ],\n",
       "       [2.92365241],\n",
       "       [2.92365241],\n",
       "       [2.84820342],\n",
       "       [2.68787408],\n",
       "       [2.62185621],\n",
       "       [2.76332331],\n",
       "       [2.73502994],\n",
       "       [2.73502994],\n",
       "       [2.63128734],\n",
       "       [2.63128734],\n",
       "       [2.63128734],\n",
       "       [2.63128734],\n",
       "       [2.64071846],\n",
       "       [2.78218555],\n",
       "       [2.67844296],\n",
       "       [2.64071846],\n",
       "       [2.65958071],\n",
       "       [2.65958071],\n",
       "       [2.65958071],\n",
       "       [2.64071846],\n",
       "       [2.64071846],\n",
       "       [2.59356284],\n",
       "       [2.67844296],\n",
       "       [2.68787408],\n",
       "       [2.68787408],\n",
       "       [2.51811385],\n",
       "       [2.51811385],\n",
       "       [2.50868273],\n",
       "       [2.37664652],\n",
       "       [2.37664652],\n",
       "       [2.35778427],\n",
       "       [2.29176641],\n",
       "       [2.2257483 ],\n",
       "       [2.0654192 ],\n",
       "       [2.0276947 ],\n",
       "       [2.0276947 ],\n",
       "       [2.04655695],\n",
       "       [1.9711076 ],\n",
       "       [1.9711076 ],\n",
       "       [1.74476039],\n",
       "       [1.73532927],\n",
       "       [1.75419164],\n",
       "       [1.48068857],\n",
       "       [1.52784431],\n",
       "       [1.18832326],\n",
       "       [1.48068857],\n",
       "       [1.41467059],\n",
       "       [1.27320361],\n",
       "       [1.36751497],\n",
       "       [1.14116764],\n",
       "       [1.14116764],\n",
       "       [1.57499993],\n",
       "       [1.59000003],\n",
       "       [1.5       ],\n",
       "       [1.40999997],\n",
       "       [1.40999997],\n",
       "       [1.27999997],\n",
       "       [1.27999997],\n",
       "       [1.27999997],\n",
       "       [1.30999994],\n",
       "       [1.30999994],\n",
       "       [1.44000006],\n",
       "       [1.54999995],\n",
       "       [1.51999998],\n",
       "       [1.45000005],\n",
       "       [1.32000005],\n",
       "       [1.33000004],\n",
       "       [1.35000002],\n",
       "       [1.33000004],\n",
       "       [1.23000002],\n",
       "       [1.25      ],\n",
       "       [1.26999998],\n",
       "       [1.26999998],\n",
       "       [1.24000001],\n",
       "       [1.42999995],\n",
       "       [1.48000002],\n",
       "       [1.32000005],\n",
       "       [1.44000006],\n",
       "       [1.32000005],\n",
       "       [1.32000005],\n",
       "       [1.34000003],\n",
       "       [1.34000003],\n",
       "       [1.34000003],\n",
       "       [1.38      ],\n",
       "       [1.30999994],\n",
       "       [1.28999996],\n",
       "       [1.33000004],\n",
       "       [1.29999995],\n",
       "       [1.29999995],\n",
       "       [1.29999995],\n",
       "       [1.29999995],\n",
       "       [1.20000005],\n",
       "       [1.20000005],\n",
       "       [1.20000005],\n",
       "       [1.41999996],\n",
       "       [1.46000004],\n",
       "       [1.46000004],\n",
       "       [1.44000006],\n",
       "       [1.45000005],\n",
       "       [1.45000005],\n",
       "       [1.45000005],\n",
       "       [1.71000004],\n",
       "       [1.83000004],\n",
       "       [1.67999995],\n",
       "       [1.63999999],\n",
       "       [1.5       ],\n",
       "       [1.48000002],\n",
       "       [1.48000002],\n",
       "       [1.48000002],\n",
       "       [1.50999999],\n",
       "       [1.51999998],\n",
       "       [1.50999999],\n",
       "       [1.50999999],\n",
       "       [1.50999999],\n",
       "       [1.50999999],\n",
       "       [1.50999999],\n",
       "       [1.50999999],\n",
       "       [1.50999999],\n",
       "       [1.47000003],\n",
       "       [1.47000003],\n",
       "       [1.55999994],\n",
       "       [1.53999996],\n",
       "       [1.50999999],\n",
       "       [1.50999999],\n",
       "       [1.50999999],\n",
       "       [1.50999999],\n",
       "       [1.50999999],\n",
       "       [1.50999999],\n",
       "       [1.53999996],\n",
       "       [1.53999996],\n",
       "       [1.53999996],\n",
       "       [1.50999999],\n",
       "       [1.50999999],\n",
       "       [1.53999996],\n",
       "       [1.53999996],\n",
       "       [1.54999995],\n",
       "       [1.54999995],\n",
       "       [1.41999996],\n",
       "       [1.41999996],\n",
       "       [1.41999996],\n",
       "       [1.41999996],\n",
       "       [1.38      ],\n",
       "       [1.38      ],\n",
       "       [1.38      ],\n",
       "       [1.38      ],\n",
       "       [1.38      ],\n",
       "       [1.38      ],\n",
       "       [1.54999995],\n",
       "       [1.54999995],\n",
       "       [1.45000005],\n",
       "       [1.41999996],\n",
       "       [1.50999999],\n",
       "       [1.39999998],\n",
       "       [1.46000004],\n",
       "       [1.47000003],\n",
       "       [1.47000003],\n",
       "       [1.45000005],\n",
       "       [1.40999997],\n",
       "       [1.40999997],\n",
       "       [1.40999997],\n",
       "       [1.40999997],\n",
       "       [1.40999997],\n",
       "       [1.44000006],\n",
       "       [1.44000006],\n",
       "       [1.44000006],\n",
       "       [1.41999996],\n",
       "       [1.28999996],\n",
       "       [1.30999994],\n",
       "       [1.30999994],\n",
       "       [1.30999994],\n",
       "       [1.34000003],\n",
       "       [1.30999994],\n",
       "       [1.30999994],\n",
       "       [1.30999994],\n",
       "       [1.25      ],\n",
       "       [1.20000005],\n",
       "       [1.20000005],\n",
       "       [1.20000005],\n",
       "       [1.25999999],\n",
       "       [1.25999999],\n",
       "       [1.25999999],\n",
       "       [1.25999999],\n",
       "       [1.25999999],\n",
       "       [1.36000001],\n",
       "       [1.36000001],\n",
       "       [1.36000001],\n",
       "       [1.40999997],\n",
       "       [1.40999997],\n",
       "       [1.46000004],\n",
       "       [1.46000004],\n",
       "       [1.46000004],\n",
       "       [1.39999998],\n",
       "       [1.39999998],\n",
       "       [1.39999998],\n",
       "       [1.46000004],\n",
       "       [1.46000004],\n",
       "       [1.47000003],\n",
       "       [1.50999999],\n",
       "       [1.50999999],\n",
       "       [1.60000002],\n",
       "       [1.60000002],\n",
       "       [1.60000002],\n",
       "       [1.57000005],\n",
       "       [1.50999999],\n",
       "       [1.60000002],\n",
       "       [1.60000002],\n",
       "       [1.57000005],\n",
       "       [1.64999998],\n",
       "       [1.64999998],\n",
       "       [1.64999998],\n",
       "       [1.80999994],\n",
       "       [1.87      ],\n",
       "       [1.88999999],\n",
       "       [1.88999999],\n",
       "       [1.94000006],\n",
       "       [1.91999996],\n",
       "       [1.98000002],\n",
       "       [2.00999999],\n",
       "       [2.00999999],\n",
       "       [2.00999999],\n",
       "       [2.1500001 ],\n",
       "       [2.1500001 ],\n",
       "       [2.08999991],\n",
       "       [2.08999991],\n",
       "       [2.08999991],\n",
       "       [2.19000006],\n",
       "       [2.19000006],\n",
       "       [2.28999996],\n",
       "       [2.22000003],\n",
       "       [2.19000006],\n",
       "       [2.19000006],\n",
       "       [2.24000001],\n",
       "       [2.1500001 ],\n",
       "       [2.1500001 ]])"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/plain": [
       "'This is scaled: '"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/plain": [
       "array([[0.03833334],\n",
       "       [0.04833334],\n",
       "       [0.05500001],\n",
       "       ...,\n",
       "       [0.38573154],\n",
       "       [0.36849235],\n",
       "       [0.36849235]])"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/plain": [
       "'x_train: '"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/plain": [
       "array([[0.03833334, 0.04833334, 0.05500001, ..., 0.06833334, 0.07      ,\n",
       "        0.06166667],\n",
       "       [0.04833334, 0.05500001, 0.05500001, ..., 0.07      , 0.06166667,\n",
       "        0.06333332],\n",
       "       [0.05500001, 0.05500001, 0.04833334, ..., 0.06166667, 0.06333332,\n",
       "        0.06666669],\n",
       "       ...,\n",
       "       [0.52333334, 0.52500001, 0.52500001, ..., 0.48109362, 0.48613622,\n",
       "        0.49454052],\n",
       "       [0.52500001, 0.52500001, 0.52500001, ..., 0.48613622, 0.49454052,\n",
       "        0.49454052],\n",
       "       [0.52500001, 0.52500001, 0.5016667 , ..., 0.49454052, 0.49454052,\n",
       "        0.53151935]])"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/plain": [
       "'y_train: '"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/plain": [
       "array([0.06333332, 0.06666669, 0.06666669, ..., 0.49454052, 0.53151935,\n",
       "       0.51302989])"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/plain": [
       "'x_train reshaped: '"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/plain": [
       "array([[[0.03833334],\n",
       "        [0.04833334],\n",
       "        [0.05500001],\n",
       "        ...,\n",
       "        [0.06833334],\n",
       "        [0.07      ],\n",
       "        [0.06166667]],\n",
       "\n",
       "       [[0.04833334],\n",
       "        [0.05500001],\n",
       "        [0.05500001],\n",
       "        ...,\n",
       "        [0.07      ],\n",
       "        [0.06166667],\n",
       "        [0.06333332]],\n",
       "\n",
       "       [[0.05500001],\n",
       "        [0.05500001],\n",
       "        [0.04833334],\n",
       "        ...,\n",
       "        [0.06166667],\n",
       "        [0.06333332],\n",
       "        [0.06666669]],\n",
       "\n",
       "       ...,\n",
       "\n",
       "       [[0.52333334],\n",
       "        [0.52500001],\n",
       "        [0.52500001],\n",
       "        ...,\n",
       "        [0.48109362],\n",
       "        [0.48613622],\n",
       "        [0.49454052]],\n",
       "\n",
       "       [[0.52500001],\n",
       "        [0.52500001],\n",
       "        [0.52500001],\n",
       "        ...,\n",
       "        [0.48613622],\n",
       "        [0.49454052],\n",
       "        [0.49454052]],\n",
       "\n",
       "       [[0.52500001],\n",
       "        [0.52500001],\n",
       "        [0.5016667 ],\n",
       "        ...,\n",
       "        [0.49454052],\n",
       "        [0.49454052],\n",
       "        [0.53151935]]])"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Epoch 1/1\n",
      " - 608s - loss: 0.0023\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "'This is closing price: '"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/plain": [
       "array([[2.480578 ],\n",
       "       [2.505331 ],\n",
       "       [2.5178137],\n",
       "       [2.503993 ],\n",
       "       [2.4808857],\n",
       "       [2.4581175],\n",
       "       [2.4405909],\n",
       "       [2.429807 ],\n",
       "       [2.4252093],\n",
       "       [2.405129 ],\n",
       "       [2.396638 ],\n",
       "       [2.4011261],\n",
       "       [2.3857915],\n",
       "       [2.3663135],\n",
       "       [2.3605633],\n",
       "       [2.3627021],\n",
       "       [2.35599  ],\n",
       "       [2.347505 ],\n",
       "       [2.3402667],\n",
       "       [2.3354175],\n",
       "       [2.318481 ],\n",
       "       [2.3002884],\n",
       "       [2.2855725],\n",
       "       [2.275917 ],\n",
       "       [2.2513006],\n",
       "       [2.2224722],\n",
       "       [2.2196198],\n",
       "       [2.2060645],\n",
       "       [2.225562 ],\n",
       "       [2.2554793],\n",
       "       [2.2930155],\n",
       "       [2.3143685],\n",
       "       [2.3229554],\n",
       "       [2.3443532],\n",
       "       [2.3652694],\n",
       "       [2.3767543],\n",
       "       [2.380358 ],\n",
       "       [2.3784811],\n",
       "       [2.3791735],\n",
       "       [2.3273757],\n",
       "       [2.2610738],\n",
       "       [2.174491 ],\n",
       "       [2.0960264],\n",
       "       [2.0398433],\n",
       "       [2.0080824],\n",
       "       [2.0140572],\n",
       "       [2.034746 ],\n",
       "       [2.0598338],\n",
       "       [2.0825372],\n",
       "       [2.083669 ],\n",
       "       [2.1060996],\n",
       "       [2.1322517],\n",
       "       [2.1132426],\n",
       "       [2.077382 ],\n",
       "       [2.0401864],\n",
       "       [1.9751813],\n",
       "       [1.936137 ],\n",
       "       [1.9169813],\n",
       "       [1.9120812],\n",
       "       [1.9157143],\n",
       "       [1.9248917],\n",
       "       [1.9298328],\n",
       "       [1.940495 ],\n",
       "       [1.94253  ],\n",
       "       [1.9399567],\n",
       "       [1.9456043],\n",
       "       [1.9376508],\n",
       "       [1.9387758],\n",
       "       [1.9569485],\n",
       "       [1.9787052],\n",
       "       [1.9971472],\n",
       "       [2.0234587],\n",
       "       [2.0467474],\n",
       "       [2.0628338],\n",
       "       [2.071153 ],\n",
       "       [2.0731475],\n",
       "       [2.0710132],\n",
       "       [2.066883 ],\n",
       "       [2.0624151],\n",
       "       [2.0586689],\n",
       "       [2.1146095],\n",
       "       [2.1855786],\n",
       "       [2.2485113],\n",
       "       [2.2930512],\n",
       "       [2.3378983],\n",
       "       [2.370837 ],\n",
       "       [2.3894613],\n",
       "       [2.3884912],\n",
       "       [2.3777845],\n",
       "       [2.3514528],\n",
       "       [2.3368855],\n",
       "       [2.3309133],\n",
       "       [2.3311343],\n",
       "       [2.3351784],\n",
       "       [2.3410993],\n",
       "       [2.3475041],\n",
       "       [2.3407812],\n",
       "       [2.3106582],\n",
       "       [2.2776802],\n",
       "       [2.249551 ],\n",
       "       [2.2685914],\n",
       "       [2.3073835],\n",
       "       [2.348067 ],\n",
       "       [2.380999 ],\n",
       "       [2.4026766],\n",
       "       [2.4135582],\n",
       "       [2.4161146],\n",
       "       [2.472459 ],\n",
       "       [2.5239446],\n",
       "       [2.5614364],\n",
       "       [2.5787349],\n",
       "       [2.5607245],\n",
       "       [2.5300333],\n",
       "       [2.4996367],\n",
       "       [2.468778 ],\n",
       "       [2.4454472],\n",
       "       [2.4316964],\n",
       "       [2.4266062],\n",
       "       [2.455476 ],\n",
       "       [2.4939613],\n",
       "       [2.5647423],\n",
       "       [2.6300566],\n",
       "       [2.677748 ],\n",
       "       [2.7196438],\n",
       "       [2.675161 ],\n",
       "       [2.6028674],\n",
       "       [2.5332181],\n",
       "       [2.480646 ],\n",
       "       [2.4487872],\n",
       "       [2.41655  ],\n",
       "       [2.3938296],\n",
       "       [2.3822138],\n",
       "       [2.422789 ],\n",
       "       [2.4620094],\n",
       "       [2.4935422],\n",
       "       [2.5219605],\n",
       "       [2.5455256],\n",
       "       [2.5491297],\n",
       "       [2.5686545],\n",
       "       [2.5890903],\n",
       "       [2.600595 ],\n",
       "       [2.604446 ],\n",
       "       [2.5971148],\n",
       "       [2.5857093],\n",
       "       [2.5859473],\n",
       "       [2.5641706],\n",
       "       [2.5383348],\n",
       "       [2.5166054],\n",
       "       [2.4890227],\n",
       "       [2.4662557],\n",
       "       [2.4367285],\n",
       "       [2.4122798],\n",
       "       [2.3966289],\n",
       "       [2.389629 ],\n",
       "       [2.37809  ],\n",
       "       [2.3681998],\n",
       "       [2.3618026],\n",
       "       [2.3478024],\n",
       "       [2.3340397],\n",
       "       [2.3235462],\n",
       "       [2.3115025],\n",
       "       [2.2961566],\n",
       "       [2.303037 ],\n",
       "       [2.2942076],\n",
       "       [2.2460992],\n",
       "       [2.2348495],\n",
       "       [2.2016113],\n",
       "       [2.1617892],\n",
       "       [2.1278374],\n",
       "       [2.1043656],\n",
       "       [2.1022015],\n",
       "       [2.1108367],\n",
       "       [2.1232154],\n",
       "       [2.134805 ],\n",
       "       [2.1432886],\n",
       "       [2.1191409],\n",
       "       [2.085236 ],\n",
       "       [2.0534225],\n",
       "       [2.0292163],\n",
       "       [2.0191908],\n",
       "       [2.0305438],\n",
       "       [2.0495234],\n",
       "       [2.0681698],\n",
       "       [2.0823882],\n",
       "       [2.0909202],\n",
       "       [2.0942528],\n",
       "       [2.1027262],\n",
       "       [2.1108718],\n",
       "       [2.1165328],\n",
       "       [2.1192076],\n",
       "       [2.1193547],\n",
       "       [2.1178327],\n",
       "       [2.1155257],\n",
       "       [2.1113358],\n",
       "       [2.1324909],\n",
       "       [2.1457164],\n",
       "       [2.152838 ],\n",
       "       [2.1552737],\n",
       "       [2.1547494],\n",
       "       [2.1618965],\n",
       "       [2.1707506],\n",
       "       [2.1876242],\n",
       "       [2.2042477],\n",
       "       [2.2041805],\n",
       "       [2.1964712],\n",
       "       [2.1920788],\n",
       "       [2.171762 ],\n",
       "       [2.149206 ],\n",
       "       [2.143399 ],\n",
       "       [2.1468177],\n",
       "       [2.1544995],\n",
       "       [2.1575608],\n",
       "       [2.1401482],\n",
       "       [2.117688 ],\n",
       "       [2.0978765],\n",
       "       [2.0839798],\n",
       "       [2.0442293],\n",
       "       [2.0025437],\n",
       "       [1.9517772],\n",
       "       [1.9089664],\n",
       "       [1.8798902],\n",
       "       [1.8645571],\n",
       "       [1.8600627],\n",
       "       [1.8625648],\n",
       "       [1.8684708],\n",
       "       [1.8330601],\n",
       "       [1.7867086],\n",
       "       [1.7715605],\n",
       "       [1.773878 ],\n",
       "       [1.7844778],\n",
       "       [1.7841692],\n",
       "       [1.7987092],\n",
       "       [1.8163266],\n",
       "       [1.8312341],\n",
       "       [1.8207978],\n",
       "       [1.800123 ],\n",
       "       [1.7780341],\n",
       "       [1.7539483],\n",
       "       [1.7338622],\n",
       "       [1.7198324],\n",
       "       [1.7117614],\n",
       "       [1.7084444],\n",
       "       [1.7083173],\n",
       "       [1.755196 ],\n",
       "       [1.8142508],\n",
       "       [1.8668262],\n",
       "       [1.9211092],\n",
       "       [1.9723516],\n",
       "       [2.0093956],\n",
       "       [2.0299337],\n",
       "       [2.0364084],\n",
       "       [2.0332847],\n",
       "       [2.0251632],\n",
       "       [2.0157537],\n",
       "       [2.0075164],\n",
       "       [2.0017257],\n",
       "       [2.0119278],\n",
       "       [2.0088265],\n",
       "       [2.0013518],\n",
       "       [1.9939353],\n",
       "       [1.988799 ],\n",
       "       [1.9828279],\n",
       "       [1.9785799],\n",
       "       [1.9767267],\n",
       "       [1.9751686],\n",
       "       [2.0442994],\n",
       "       [2.089303 ],\n",
       "       [2.1740549],\n",
       "       [2.2570238],\n",
       "       [2.3198478],\n",
       "       [2.369059 ],\n",
       "       [2.4160748],\n",
       "       [2.464728 ],\n",
       "       [2.456415 ],\n",
       "       [2.4232826],\n",
       "       [2.3846853],\n",
       "       [2.3322175],\n",
       "       [2.2863743],\n",
       "       [2.2394578],\n",
       "       [2.2047515],\n",
       "       [2.1719902],\n",
       "       [2.1499956],\n",
       "       [2.1399443],\n",
       "       [2.145407 ],\n",
       "       [2.1490686],\n",
       "       [2.1527395],\n",
       "       [2.1716633],\n",
       "       [2.1937273],\n",
       "       [2.212686 ],\n",
       "       [2.225756 ],\n",
       "       [2.2499475],\n",
       "       [2.2863755],\n",
       "       [2.2939904],\n",
       "       [2.2861578],\n",
       "       [2.2715497],\n",
       "       [2.2754889],\n",
       "       [2.2860985],\n",
       "       [2.3109524],\n",
       "       [2.3225813],\n",
       "       [2.3255663],\n",
       "       [2.323347 ],\n",
       "       [2.3188572],\n",
       "       [2.3141553],\n",
       "       [2.3104157],\n",
       "       [2.308109 ],\n",
       "       [2.307227 ],\n",
       "       [2.3075018],\n",
       "       [2.3124607],\n",
       "       [2.3578265],\n",
       "       [2.4112399],\n",
       "       [2.516739 ],\n",
       "       [2.584308 ],\n",
       "       [2.6186442],\n",
       "       [2.6313941],\n",
       "       [2.6025777],\n",
       "       [2.5607116],\n",
       "       [2.521456 ],\n",
       "       [2.5002944],\n",
       "       [2.4867098],\n",
       "       [2.4751337],\n",
       "       [2.4685595],\n",
       "       [2.4670281],\n",
       "       [2.4773383],\n",
       "       [2.491656 ],\n",
       "       [2.493597 ],\n",
       "       [2.4903328],\n",
       "       [2.5134764],\n",
       "       [2.5250206],\n",
       "       [2.5294323],\n",
       "       [2.5133414],\n",
       "       [2.4581516],\n",
       "       [2.3849547],\n",
       "       [2.349643 ],\n",
       "       [2.3336236],\n",
       "       [2.3318076],\n",
       "       [2.3169186],\n",
       "       [2.3008895],\n",
       "       [2.2884095],\n",
       "       [2.2808764],\n",
       "       [2.2796922],\n",
       "       [2.3110008],\n",
       "       [2.3285365],\n",
       "       [2.328529 ],\n",
       "       [2.3236847],\n",
       "       [2.3166955],\n",
       "       [2.3095999],\n",
       "       [2.2996066],\n",
       "       [2.2901742],\n",
       "       [2.273089 ],\n",
       "       [2.273727 ],\n",
       "       [2.2837932],\n",
       "       [2.296114 ],\n",
       "       [2.271812 ],\n",
       "       [2.2367985],\n",
       "       [2.202278 ],\n",
       "       [2.1491947],\n",
       "       [2.1005185],\n",
       "       [2.0613465],\n",
       "       [2.0231833],\n",
       "       [1.9822971],\n",
       "       [1.9191813],\n",
       "       [1.8538933],\n",
       "       [1.8025494],\n",
       "       [1.7733238],\n",
       "       [1.7476002],\n",
       "       [1.7304051],\n",
       "       [1.6790109],\n",
       "       [1.6218811],\n",
       "       [1.57739  ],\n",
       "       [1.4983141],\n",
       "       [1.4290907],\n",
       "       [1.3182949],\n",
       "       [1.2629349],\n",
       "       [1.2332182],\n",
       "       [1.1985517],\n",
       "       [1.185694 ],\n",
       "       [1.1467783],\n",
       "       [1.1034406],\n",
       "       [1.1410064],\n",
       "       [1.2139215],\n",
       "       [1.2742473],\n",
       "       [1.2990413],\n",
       "       [1.2995235],\n",
       "       [1.2625194],\n",
       "       [1.2132428],\n",
       "       [1.1663158],\n",
       "       [1.1342117],\n",
       "       [1.1152147],\n",
       "       [1.129155 ],\n",
       "       [1.17604  ],\n",
       "       [1.2246737],\n",
       "       [1.2516923],\n",
       "       [1.2386613],\n",
       "       [1.2098762],\n",
       "       [1.181861 ],\n",
       "       [1.1558425],\n",
       "       [1.1184229],\n",
       "       [1.0867712],\n",
       "       [1.0678898],\n",
       "       [1.0595038],\n",
       "       [1.0533539],\n",
       "       [1.0832487],\n",
       "       [1.1342692],\n",
       "       [1.1576571],\n",
       "       [1.1841341],\n",
       "       [1.1845323],\n",
       "       [1.1717075],\n",
       "       [1.1577667],\n",
       "       [1.1455343],\n",
       "       [1.1363403],\n",
       "       [1.137441 ],\n",
       "       [1.1309639],\n",
       "       [1.1187758],\n",
       "       [1.1132926],\n",
       "       [1.106963 ],\n",
       "       [1.1017659],\n",
       "       [1.0983362],\n",
       "       [1.09665  ],\n",
       "       [1.0788499],\n",
       "       [1.0570065],\n",
       "       [1.0375572],\n",
       "       [1.0615796],\n",
       "       [1.1096808],\n",
       "       [1.1607558],\n",
       "       [1.1994665],\n",
       "       [1.2255089],\n",
       "       [1.23914  ],\n",
       "       [1.2429799],\n",
       "       [1.2874817],\n",
       "       [1.3640914],\n",
       "       [1.4124516],\n",
       "       [1.4289677],\n",
       "       [1.399341 ],\n",
       "       [1.3493308],\n",
       "       [1.2991911],\n",
       "       [1.2592595],\n",
       "       [1.23837  ],\n",
       "       [1.2336721],\n",
       "       [1.2372103],\n",
       "       [1.2452295],\n",
       "       [1.2547723],\n",
       "       [1.2638779],\n",
       "       [1.2714598],\n",
       "       [1.2771008],\n",
       "       [1.2808304],\n",
       "       [1.2757256],\n",
       "       [1.267423 ],\n",
       "       [1.2753493],\n",
       "       [1.2858093],\n",
       "       [1.2901119],\n",
       "       [1.2904927],\n",
       "       [1.2886776],\n",
       "       [1.2859957],\n",
       "       [1.2833172],\n",
       "       [1.281112 ],\n",
       "       [1.2849672],\n",
       "       [1.2909337],\n",
       "       [1.2967566],\n",
       "       [1.2958664],\n",
       "       [1.2918799],\n",
       "       [1.2925037],\n",
       "       [1.2951444],\n",
       "       [1.3000865],\n",
       "       [1.3051331],\n",
       "       [1.2856956],\n",
       "       [1.2586298],\n",
       "       [1.2332181],\n",
       "       [1.2139165],\n",
       "       [1.1947502],\n",
       "       [1.1800537],\n",
       "       [1.1709269],\n",
       "       [1.1668271],\n",
       "       [1.1664426],\n",
       "       [1.168296 ],\n",
       "       [1.2013061],\n",
       "       [1.2430289],\n",
       "       [1.2627155],\n",
       "       [1.2619233],\n",
       "       [1.2667161],\n",
       "       [1.2525538],\n",
       "       [1.2425889],\n",
       "       [1.2378342],\n",
       "       [1.2364051],\n",
       "       [1.2332416],\n",
       "       [1.2227325],\n",
       "       [1.2108433],\n",
       "       [1.2007095],\n",
       "       [1.1936375],\n",
       "       [1.1897224],\n",
       "       [1.1937374],\n",
       "       [1.2010309],\n",
       "       [1.208691 ],\n",
       "       [1.2115108],\n",
       "       [1.1882906],\n",
       "       [1.1607952],\n",
       "       [1.1365284],\n",
       "       [1.1188519],\n",
       "       [1.1135   ],\n",
       "       [1.1103405],\n",
       "       [1.1093211],\n",
       "       [1.1097877],\n",
       "       [1.1005427],\n",
       "       [1.0798225],\n",
       "       [1.057642 ],\n",
       "       [1.0391358],\n",
       "       [1.0366086],\n",
       "       [1.0426117],\n",
       "       [1.0519075],\n",
       "       [1.061069 ],\n",
       "       [1.0682641],\n",
       "       [1.0903615],\n",
       "       [1.1150792],\n",
       "       [1.1358998],\n",
       "       [1.1589916],\n",
       "       [1.1778665],\n",
       "       [1.1991746],\n",
       "       [1.2166063],\n",
       "       [1.2279673],\n",
       "       [1.2226069],\n",
       "       [1.2097257],\n",
       "       [1.1953222],\n",
       "       [1.1936328],\n",
       "       [1.1984756],\n",
       "       [1.2076372],\n",
       "       [1.2244949],\n",
       "       [1.2418816],\n",
       "       [1.2724701],\n",
       "       [1.3032289],\n",
       "       [1.3278021],\n",
       "       [1.3385566],\n",
       "       [1.3290861],\n",
       "       [1.3278556],\n",
       "       [1.3303506],\n",
       "       [1.3287401],\n",
       "       [1.3402131],\n",
       "       [1.3556209],\n",
       "       [1.3700343],\n",
       "       [1.4106274],\n",
       "       [1.4665917],\n",
       "       [1.5222528],\n",
       "       [1.5657623],\n",
       "       [1.6029816],\n",
       "       [1.6243323],\n",
       "       [1.6441064],\n",
       "       [1.6635629],\n",
       "       [1.6779839],\n",
       "       [1.6864269],\n",
       "       [1.7168946],\n",
       "       [1.7507883],\n",
       "       [1.7674834],\n",
       "       [1.772493 ],\n",
       "       [1.7706336],\n",
       "       [1.7853626],\n",
       "       [1.8046817],\n",
       "       [1.8421713],\n",
       "       [1.866434 ],\n",
       "       [1.8738244],\n",
       "       [1.8716516],\n",
       "       [1.8751923],\n",
       "       [1.8629277]], dtype=float32)"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "0.33546997496316294\n"
     ]
    },
    {
     "ename": "IndexError",
     "evalue": "only integers, slices (`:`), ellipsis (`...`), numpy.newaxis (`None`) and integer or boolean arrays are valid indices",
     "output_type": "error",
     "traceback": [
      "\u001b[0;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[0;31mIndexError\u001b[0m                                Traceback (most recent call last)",
      "\u001b[0;32m<ipython-input-12-d67bb08b43e3>\u001b[0m in \u001b[0;36m<module>\u001b[0;34m\u001b[0m\n\u001b[1;32m    105\u001b[0m \u001b[0mtrain\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mdataset\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;36m0\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;36m2196\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    106\u001b[0m \u001b[0mvalid\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mdataset\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;36m2196\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 107\u001b[0;31m \u001b[0mvalid\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;34m'Predictions'\u001b[0m\u001b[0;34m]\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mclosing_price\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    108\u001b[0m \u001b[0mplt\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mplot\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mtrain\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;34m'Close'\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    109\u001b[0m \u001b[0mplt\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mplot\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mvalid\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;34m'Close'\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m'Predictions'\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
      "\u001b[0;31mIndexError\u001b[0m: only integers, slices (`:`), ellipsis (`...`), numpy.newaxis (`None`) and integer or boolean arrays are valid indices"
     ]
    }
   ],
   "source": [
    "import pandas as pd\n",
    "import pandas_datareader.data as web\n",
    "import numpy as np\n",
    "from sklearn.model_selection import train_test_split\n",
    "from sklearn.preprocessing import MinMaxScaler\n",
    "from keras.models import Sequential\n",
    "from keras.layers import Dense, Dropout, LSTM\n",
    "\n",
    "import matplotlib.pyplot as plt\n",
    "from matplotlib import rcParams\n",
    "import datetime as dt\n",
    "\n",
    "#Data Collection#\n",
    "stocks = ['RBSPF']\n",
    "\n",
    "start = dt.datetime(2010, 1, 1)\n",
    "end = dt.datetime(2030, 1, 27)\n",
    "\n",
    "data = web.DataReader('RBSPF', 'yahoo', start, end)\n",
    "\n",
    "#Data pre-processing#\n",
    "\n",
    "dates =[]\n",
    "for x in range(len(data)):\n",
    "    '''Remove the level index caused by the multiple layers in the original dataset'''\n",
    "    newdate = str(data.index[x])\n",
    "    newdate = newdate[0:10]\n",
    "    dates.append(newdate)\n",
    "\n",
    "data['Dates'] = dates\n",
    "data['Dates'] = pd.to_datetime(data[\"Dates\"])\n",
    "data.reset_index(drop=True, inplace=True)\n",
    "#data['Dates'] = (data['Dates'] - data['Dates'].min()) / np.timedelta64(1,'D')\n",
    "data = data.drop(data.columns[[0, 1, 2, 3, 4]], axis=1)\n",
    "data = data[['Dates', 'Adj Close']]\n",
    "display(data)\n",
    "\n",
    "for i in range(0,len(data)):\n",
    "    data['Dates'][i] = data['Dates'][i]\n",
    "    data['Adj Close'][i] = data['Adj Close'][i]\n",
    "\n",
    "#Setting Index\n",
    "data.index = data.Dates\n",
    "data.drop('Dates', axis=1, inplace=True)\n",
    "\n",
    "\n",
    "#Creating train and test sets\n",
    "dataset = data.values\n",
    "display(dataset)\n",
    "print(dataset.shape)\n",
    "\n",
    "train = dataset[0:2196]\n",
    "valid = dataset[2196:]\n",
    "display(train)\n",
    "display(valid)\n",
    "\n",
    "#Converting dataset into x_train and y_train\n",
    "scaler = MinMaxScaler(feature_range=(0, 1))\n",
    "scaled_Data = scaler.fit_transform(dataset)\n",
    "display('This is scaled: ', scaled_Data)\n",
    "\n",
    "\n",
    "x_train, y_train = [], []\n",
    "for i in range(60,len(train)):\n",
    "    x_train.append(scaled_Data[i-60:i,0])\n",
    "    y_train.append(scaled_Data[i,0])\n",
    "x_train, y_train = np.array(x_train), np.array(y_train)\n",
    "\n",
    "display('x_train: ', x_train)\n",
    "display('y_train: ', y_train)\n",
    "\n",
    "x_train = np.reshape(x_train, (x_train.shape[0],x_train.shape[1],1))\n",
    "display('x_train reshaped: ', x_train)\n",
    "\n",
    "# create and fit the LSTM network\n",
    "model = Sequential()\n",
    "model.add(LSTM(units=50, return_sequences=True, input_shape=(x_train.shape[1],1)))\n",
    "model.add(LSTM(units=50))\n",
    "model.add(Dense(1))\n",
    "\n",
    "model.compile(loss='mean_squared_error', optimizer='adam')\n",
    "model.fit(x_train, y_train, epochs=1, batch_size=1, verbose=2)\n",
    "\n",
    "\n",
    "#predicting 246 values, using past 60 from the train data\n",
    "inputs = data[len(data) - len(valid) - 60:].values\n",
    "inputs = inputs.reshape(-1,1)\n",
    "inputs  = scaler.transform(inputs)\n",
    "\n",
    "X_test = []\n",
    "for i in range(60,inputs.shape[0]):\n",
    "    X_test.append(inputs[i-60:i,0])\n",
    "X_test = np.array(X_test)\n",
    "\n",
    "X_test = np.reshape(X_test, (X_test.shape[0],X_test.shape[1],1))\n",
    "closing_price = model.predict(X_test)\n",
    "closing_price = scaler.inverse_transform(closing_price)\n",
    "\n",
    "display('This is closing price: ', closing_price)\n",
    "\n",
    "rms=np.sqrt(np.mean(np.power((valid-closing_price),2)))\n",
    "print(rms)\n",
    "\n",
    "#for plotting\n",
    "train = dataset[0:2196]\n",
    "valid = dataset[2196:]\n",
    "valid['Predictions'] = closing_price\n",
    "plt.plot(train['Close'])\n",
    "plt.plot(valid[['Close','Predictions']])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.7.9"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 4
}
